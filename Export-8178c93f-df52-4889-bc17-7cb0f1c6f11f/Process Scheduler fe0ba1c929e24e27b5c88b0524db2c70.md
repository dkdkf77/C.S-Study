# Process Scheduler

스케줄러의 종류 

- 장기 스케쥴러(long term scheduler)
- 중기 스케쥴러(medium term scheduler)
- 단기 스케쥴러(short term scheduler)

요즘은 단기 스케쥴러만 남아 있다고 하지만 예전에는 종류가 3가지가 있다고 한다.

들어가기 전 알아둬야 할 용어 

- Job, Queue

    프로그램 과 프로세스의 차이

    ![스크린샷 2021-08-23 오전 10.54.41.png](Process%20Scheduler%20fe0ba1c929e24e27b5c88b0524db2c70/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2021-08-23_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_10.54.41.png)

Job 이란?

Queue 란?

스케줄링이란 ? - 자원을 할당 할 프로세스를 선택 

스케줄링의 목적 - 시스템의 성능 향상 

- 응답시간
- 작업 처리량
- 자원 활용도

**Job Queue**

즉, secondary storage에 있는 프로세스가 메모리로 load 될 때 secondary storage에 형성되어 있는 큐라고 볼 수 있음.

**Ready Queue**

Ready 상태에 있는 프로세스들. 즉, 메모리에 load 되어있는 프로세스들이 ready queue에 쌓여있는다. 따라서, ready queue는 메모리에 load 되어있는 queue라고 할 수 있다.

**Device Queue**

ready queue가 메모리에 있다면 device queue는 device controller에 있다. device controller는 쉽게말해 하드웨어 그 자체이다.

![1.png](Process%20Scheduler%20fe0ba1c929e24e27b5c88b0524db2c70/1.png)

long-term scheduler는 secondary storage에 저장되어있는 job queue로부터 프로세스를 끌어와서 메모리에 load시킨다.

ready 상태에 있는 PCB1은 short-term scheduler에 의해 CPU점유권을 갖게된다. CPU 점유권을 갖고있는 상태에서 I/O request가 들어오면 해당 PCB1은 CPU 점유권을 잃고 device controller 안에 있는 buffer의 device queue로 들어가게 된다.

![2.png](Process%20Scheduler%20fe0ba1c929e24e27b5c88b0524db2c70/2.png)

장기 스케줄러? 

수행해야 할 job 10개가 있는데 메모리에 6개 밖에 올릴 수 없는 상황

10개 중 어떤 녀석을 골라 메모리에 올릴까? 

![스크린샷 2021-08-23 오후 5.07.32.png](Process%20Scheduler%20fe0ba1c929e24e27b5c88b0524db2c70/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2021-08-23_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5.07.32.png)

풀로 부터 프로세스들을 선별하고 실행을 위해 메모리에 load

단기 스케줄러 ?

롱텀 스케줄러에 의해 6개의 잡이 메모리에 들어 갔고  Cpu는 하나 인데 6개 중 하나를 골라야 하고 이것을 골라 주는 아이가 단기 스케줄러 !

![스크린샷 2021-08-23 오후 5.10.32.png](Process%20Scheduler%20fe0ba1c929e24e27b5c88b0524db2c70/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2021-08-23_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5.10.32.png)

실행이 준비된 프로세스들 중 하나를 선별해 CPU에게 할당 

 중기 스케줄러란?

10개 프로그램 중 6개를 올려서 수행하고 있을 때 CPU에서 수행하려고 했떠니 이 6개 CPU가 감당하기엔 너무 많은 것 같을 때 이 프로세서가 많아서 문제가 생겼다. 그럴때 6개 중 뭘 골라서 ready Queue로 돌려 줌 이것이 중기 스케줄러 

중기 스케줄러는 프로세스를 내릴 때 우선순위가 가장 낮은 프로세스나 일정 시간 동안 활정되지 않았던 프로세스를 우선 적으로 내린다.

![스크린샷 2021-08-23 오후 5.16.14.png](Process%20Scheduler%20fe0ba1c929e24e27b5c88b0524db2c70/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2021-08-23_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_5.16.14.png)

![다운로드.png](Process%20Scheduler%20fe0ba1c929e24e27b5c88b0524db2c70/%E1%84%83%E1%85%A1%E1%84%8B%E1%85%AE%E1%86%AB%E1%84%85%E1%85%A9%E1%84%83%E1%85%B3.png)

### **장기 스케줄러(long term scheduler) : 어떤 프로세스를 준비큐에 넣을 것인가 ?**

 프로세스를 시스템에 얼마나 넣어 줄껀지 조절 해준다

 **작업 스케줄러**라고도 부르며 어떤 프로세스를 준비 큐에 삽입할지를 결정하는 역할을 합니다. 디스크에서 하나의 프로그램을 가져와 커널에 등록하면 프로세스가 되는데 이때 디스크에서 어떤 프로그램을 가져와 커널에 등록할지결정합니다.

Ready Queue?  메모리에 load 되어 있는 준비 상태 

장기 스케줄러는 수십 초 내지 수 분 단위로 가끔 호출되기 때문에 상대적으로 속도가 느린 것이 허용됩니다. 또한 장기 스케줄러는 **메모리에 동시에 올라가 있는 프로세스의 수를 조절**하는 역할을 한다.

하지만 현대의 시분할 시스템에서 사용되는 운영 체제에는 일반적으로 장기 스케줄러를 두지 않는 경우가 대부분입니다. 과거에는 적은 양의 메로리를 많은 프로세스들에게 할당하면 프로세스당 메모리 보유량이 적어져 장기 스케줄러가 이를 조절하는 역할을 했지만 현대의 운영체제 에서는 프로세스가 시작되면 장기 스케줄러 없이 바로 그 프로세스에 메모리를 할당해 준비 큐에 넣어주게 됩니다.

### **단기 스케줄러(short term scheduler) : 어떤 프로세스에게 cpu를 할당해 줄 것인가 ?**

CPU스케줄러라고도 하며 **준비 상태의 프로세스 중에서 어떤 프로세스를 다음 번에 실행 상태로 만들 것인지를 결정**합니다. 시분한 시스템에서 타이머 인터럽트가 발생하면 단기 스케줄러가 호출됩니다.

일반적으로 **스케줄러라 함은 단기 스케줄러를 의미**하며 단기 스케줄러는 미리 정한 스케줄링 알고리즘에 따라 cpu를 할당 할 프로세스를 선택합니다.

단기 스케줄러는 밀리 세컨트(ms) 이하의 시간 단위로 매우 빈번하게 호출되기 때문에 수행 속도가 충분히 빨라야 합니다.

### **중기 스케줄러(medium term scheduler) : 메모리에 적재된 프로세스 수 관리**

너무 많은 프로스스에게 메모리를 할당해 시스템의 성능이 저하되는 경우 이를 해결하기 위해 메모리에 적재된 프로세스의 수를 동적으로 조절하기 위해 추가된 스케줄러 입니다.

만약 메모리에 많은 수의 프로세스가 적재되어 프로세스 당 보유하고 있는 메모리량이 극도로 적어지게 되면 CPU 수행에 당장 필요한 프로세스의 주소 공간조차도 메모리에 올려놓기 어려운 상황이 발생하게 됩니다 그렇게 되면 디스크 I/O가 수시로 발생하게 되어 시스템의 성능이 심각하게 저하될 수 있습니다. 이런 경우 메모리에 올라와 있는 프로세스 중 일부로 부터 메모리를 통째로 빼앗아 그 내용을 디스크의 스왑 영역에 저장해 둡니다. 이와 같은 행위를 스왑 아웃(swap out)이라고 합니다.

디스크로 스왑 아웃시켜야 하는 경우 봉쇄 상태에 있는 프로세스들을 첫번째로 스왑 아웃 시킵니다. 이유는 봉쇄 상태의 프로세스들은 당장 CPU를 획득할 가능성이 없기 때문 입니다.

봉쇄 상태의 프로세스들을 스왑 아웃시켜도 문제가 해결되지 않는 경우 중기 스케줄러는 타이머 인터럽트가 발생해 준비 큐로 이동하는 프로세스를 추가적으로 스왑아웃 시킵니다. 중기 스케줄러는 이러한 방식으로 장기 스케줄러와 마찬가지로 메모리에 올라와 있는 프로세스의 수를 조절하는 역할을 합니다.

중기 스케줄러의 등장으로 프로세스의 상태에는 중지(suspenden, stopped) 상태가 추가 되었으며 중지 상태의 프로세스는 메모리를 통째로 빼앗기고 디스크로 스왑 아웃된다. 중지 상태는 중지 준비 상태와 봉쇄 중지 상태가 있다.